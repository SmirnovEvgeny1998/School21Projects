# Day 07 - Piscine SQL

## Задача
1. Давайте сделаем простую агрегацию. Напишите оператор SQL, который возвращает идентификаторы людей и соответствующее количество посещений в любой пиццерии, а также сортирует по количеству посещений в порядке убывания и сортирует по `person_id` в порядке возрастания.
2. Измените SQL-оператор из упражнения 00 так, чтобы он возвращал имя человека (не идентификатор). Дополнительное условие: нам нужно найти только первых четырёх человек с максимальным количеством посещений всех пиццерий, отсортированных по имени.
3. Напишите SQL-запрос, чтобы отобразить 3 любимых ресторана по посещениям и заказам в одном списке (добавьте столбец action_type со значениями «order» или «visit», в зависимости от данных в соответствующей таблице). Взгляните на пример данных ниже. Результат должен быть отсортирован по столбцу action_type по возрастанию и по столбцу count по убыванию.
4. Напишите SQL-запрос, чтобы увидеть, как рестораны группируются по посещениям и заказам и объединяются друг с другом по названию ресторана.
Вы можете использовать внутренние SQL-запросы из упражнения 02 (рестораны по посещениям и заказам) без ограничений по количеству строк.
Кроме того, добавьте следующие правила.
- вычислить сумму заказов и посещений для соответствующей пиццерии (обратите внимание, что не все ключи пиццерий представлены в обеих таблицах).
- отсортировать результаты по столбцу `total_count` в порядке убывания и по `name` в порядке возрастания.
5. Напишите SQL-оператор, который возвращает имя человека и соответствующее количество посещений любой пиццерии, если человек посетил ее более 3 раз (> 3).
6. Напишите простой SQL-запрос, который возвращает список уникальных имён людей, сделавших заказы в любой пиццерии. Результат должен быть отсортирован по имени человека.
7. Напишите SQL-запрос, который возвращает количество заказов, среднюю цену, максимальную и минимальную цены проданной пиццы в соответствующей пиццерии. Результат должен быть отсортирован по названию пиццерии. Ознакомьтесь с примером данных ниже.
Округлите среднюю цену до двух чисел с плавающей точкой.
| name | count_of_orders | average_price | max_price | min_price |
| ------ | ------ | ------ | ------ | ------ |
| Best Pizza | 5 | 780 | 850 | 700 |
| DinoPizza | 5 | 880 | 1000 | 800 |
| ... | ... | ... | ... | ... |
8. Напишите SQL-запрос, который возвращает общий средний рейтинг (имя выходного атрибута — global_rating) для всех ресторанов. Округлите средний рейтинг до четырёх чисел с плавающей точкой.
9. Из наших данных мы знаем адреса людей. Предположим, что этот человек посещает пиццерии только в своём городе. Напишите SQL-запрос, который возвращает адрес, название пиццерии и сумму заказов этого человека. Результат необходимо отсортировать по адресу, а затем по названию ресторана.
10. Напишите SQL-запрос, который возвращает агрегированную информацию по адресу человека, результат «Максимальный возраст - (Минимальный возраст / Максимальный возраст)», представленный в виде столбца с формулой, затем средний возраст по адресу и результат сравнения между столбцами формулы и средним значением (другими словами, если значение формулы больше среднего, то значение True, в противном случае — False).
Результат должен быть отсортирован по столбцу с адресом.
## Срок выполнения
Отведено: 1 день(8 часов).
Дополнительные задачи: отсутствуют.
Выполнено за 1 день.
## Тип проекта
Индивидуальный, весь проект выполнен мной.
## Используемые языки/технологии/библиотеки.
SQL, PostgreSQL.
